# LangGraph QA System

ê³ ë„í™”ëœ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œì„ ìœ„í•œ LangGraph ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
langgraph-study/
â”œâ”€â”€ main.py                    # ë©”ì¸ ì‹¤í–‰ íŒŒì¼
â””â”€â”€ graph/                     # ê·¸ë˜í”„ ê´€ë ¨ ëª¨ë“ˆ
    â”œâ”€â”€ config.py              # ê³µí†µ ì„¤ì • (LLM, API í‚¤ ë“±)
    â”œâ”€â”€ graph_builder.py       # ê·¸ë˜í”„ ë¹Œë”
    â”œâ”€â”€ models/                # ë°ì´í„° ëª¨ë¸ë“¤
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ state.py           # QAState ì •ì˜
    â”œâ”€â”€ logic/                 # ë¶„ê¸° ë¡œì§ë“¤
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ decision.py        # ì˜ì‚¬ê²°ì • ë¡œì§
    â”‚   â””â”€â”€ classification.py  # ë¶„ë¥˜ ë¡œì§
    â”œâ”€â”€ utils/                 # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ search.py          # ê²€ìƒ‰ ê´€ë ¨
    â”‚   â”œâ”€â”€ formatting.py      # í¬ë§·íŒ… ê´€ë ¨
    â”‚   â””â”€â”€ validation.py      # ê²€ì¦ ê´€ë ¨
    â””â”€â”€ nodes/                 # ì‹¤í–‰ ë…¸ë“œë“¤
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ basic_nodes.py     # ê¸°ë³¸ ë…¸ë“œë“¤
        â””â”€â”€ rag_node.py        # RAG ë…¸ë“œë“¤
```

## ğŸ”„ ì›Œí¬í”Œë¡œìš°

### ì „ì²´ í”Œë¡œìš° ë‹¤ì´ì–´ê·¸ë¨

```
ì‹œì‘
  â†“
ì§ˆë¬¸ ë¶„ë¥˜ â†’ RAG í•„ìš”ì„± í™•ì¸
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RAG í”Œë¡œìš°    â”‚   ê¸°ë³¸ í”Œë¡œìš°   â”‚
â”‚                 â”‚                 â”‚
â”‚ ë¬¸ì„œ ê²€ìƒ‰       â”‚ ë‹µë³€ ìƒì„±       â”‚
â”‚ â†“               â”‚ â†“               â”‚
â”‚ RAG ë‹µë³€ ìƒì„±   â”‚ í’ˆì§ˆ í‰ê°€       â”‚
â”‚ â†“               â”‚ â†“               â”‚
â”‚ RAG í’ˆì§ˆ í™•ì¸   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â†“               â”‚ â”‚ í’ˆì§ˆ ê²°ê³¼   â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ good        â”‚ â”‚
â”‚ â”‚ ë§Œì¡±        â”‚ â”‚ â”‚ regenerate  â”‚ â”‚
â”‚ â”‚ ë¶ˆë§Œì¡±      â”‚ â”‚ â”‚ search_more â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â†“               â”‚ â†“               â”‚
â”‚ ë§Œì¡±ë„ í™•ì¸     â”‚ ë§Œì¡±ë„ í™•ì¸     â”‚
â”‚ â†“               â”‚ â†“               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ë§Œì¡±        â”‚ â”‚ â”‚ ë§Œì¡±        â”‚ â”‚
â”‚ â”‚ ë¶ˆë§Œì¡±      â”‚ â”‚ â”‚ ë¶ˆë§Œì¡±      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â†“               â”‚ â†“               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                  ì¢…ë£Œ (END)
```

### ìƒì„¸ ì›Œí¬í”Œë¡œìš°

1. **ì§ˆë¬¸ ë¶„ë¥˜** (`classify_question`)
   - ì§ˆë¬¸ ìœ í˜• ë¶„ì„ (ì—­ì‚¬, ìˆ˜í•™, ë²ˆì—­, ì¼ë°˜)
   - `question_type` í•„ë“œì— ê²°ê³¼ ì €ì¥

2. **RAG í•„ìš”ì„± í™•ì¸** (`check_rag_needed`)
   - í‚¤ì›Œë“œ ê¸°ë°˜ RAG ì‚¬ìš© ì—¬ë¶€ ê²°ì •
   - "ìµœì‹ ", "2024", "ìµœê·¼" ë“± í‚¤ì›Œë“œ ê°ì§€

3. **ë¶„ê¸° ì²˜ë¦¬**
   - **RAG í”Œë¡œìš°**: ë¬¸ì„œ ê²€ìƒ‰ â†’ RAG ë‹µë³€ ìƒì„± â†’ í’ˆì§ˆ í™•ì¸
   - **ê¸°ë³¸ í”Œë¡œìš°**: ë‹µë³€ ìƒì„± â†’ í’ˆì§ˆ í‰ê°€

4. **í’ˆì§ˆ ê´€ë¦¬**
   - ë‹µë³€ í’ˆì§ˆ í‰ê°€ ë° ê°œì„  ë°©í–¥ ì œì‹œ
   - ì¬ìƒì„±, ì¶”ê°€ ê²€ìƒ‰, ë§Œì¡±ë„ í™•ì¸ ë“±

5. **ìµœì¢… í™•ì¸**
   - ì‚¬ìš©ì ë§Œì¡±ë„ í™•ì¸
   - í•„ìš”ì‹œ ì¬ì‹œë„ ë˜ëŠ” ì¢…ë£Œ

## ğŸ§© ë…¸ë“œ êµ¬ì„±

### ê¸°ë³¸ ë…¸ë“œë“¤ (`basic_nodes.py`)

- **`generate_answer_node`**: ê¸°ë³¸ ë‹µë³€ ìƒì„±
- **`check_satisfaction_node`**: ë‹µë³€ ë§Œì¡±ë„ í™•ì¸
- **`evaluate_quality_node`**: ë‹µë³€ í’ˆì§ˆ í‰ê°€

### RAG ë…¸ë“œë“¤ (`rag_node.py`)

- **`search_documents_node`**: ë¬¸ì„œ ê²€ìƒ‰
- **`generate_rag_answer_node`**: RAG ê¸°ë°˜ ë‹µë³€ ìƒì„±
- **`check_rag_quality_node`**: RAG ë‹µë³€ í’ˆì§ˆ í™•ì¸

### ë¡œì§ ë…¸ë“œë“¤

- **`classify_question`**: ì§ˆë¬¸ ë¶„ë¥˜ ë¡œì§
- **`should_use_rag`**: RAG ì‚¬ìš© ì—¬ë¶€ ê²°ì •
- **`decide_next`**: ë‹¤ìŒ ë‹¨ê³„ ê²°ì •

## ğŸ“Š ìƒíƒœ ê´€ë¦¬ (QAState)

```python
class QAState(TypedDict):
    question: str                    # ì‚¬ìš©ì ì§ˆë¬¸
    answer: Optional[str]            # ìƒì„±ëœ ë‹µë³€
    satisfied: Optional[bool]        # ë§Œì¡±ë„
    tries: int                       # ì‹œë„ íšŸìˆ˜

    retrieved_documents: Optional[List[str]]  # ê²€ìƒ‰ëœ ë¬¸ì„œë“¤
    document_sources: Optional[List[str]]     # ë¬¸ì„œ ì¶œì²˜ë“¤
    search_query: Optional[str]      # ê²€ìƒ‰ ì¿¼ë¦¬
    use_rag: bool                    # RAG ì‚¬ìš© ì—¬ë¶€
    quality_score: Optional[str]     # í’ˆì§ˆ ì ìˆ˜
    needs_regeneration: Optional[bool]  # ì¬ìƒì„± í•„ìš” ì—¬ë¶€
    needs_more_search: Optional[bool]   # ì¶”ê°€ ê²€ìƒ‰ í•„ìš” ì—¬ë¶€
    question_type: Optional[str]     # ì§ˆë¬¸ ë¶„ë¥˜ ê²°ê³¼
```

## ğŸš€ ì‚¬ìš© ë°©ë²•

### 1. í™˜ê²½ ì„¤ì •

```bash
# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# í™˜ê²½ë³€ìˆ˜ ì„¤ì •
export OPENAI_API_KEY="your-api-key-here"
```

### 2. ì‹¤í–‰

```bash
python main.py
```

### 3. ì‚¬ìš© ì˜ˆì‹œ

```
ğŸ’¬ LangGraph ì±—ë´‡ì…ë‹ˆë‹¤. ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”. ì¢…ë£Œí•˜ë ¤ë©´ 'exit'ì„ ì…ë ¥í•˜ì„¸ìš”.

â“ ì§ˆë¬¸: ê³ êµ¬ë ¤ì˜ ì—­ì‚¬ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”
ğŸ§  ë‹µë³€: ê³ êµ¬ë ¤ëŠ” ê¸°ì›ì „ 37ë…„ì— ê±´êµ­ëœ ê³ ëŒ€ í•œêµ­ì˜ ì™•êµ­ì…ë‹ˆë‹¤...

â“ ì§ˆë¬¸: 2024ë…„ ìµœì‹  AI ê¸°ìˆ  ë™í–¥ì€?
ğŸ§  ë‹µë³€: [RAG ê¸°ë°˜ ë‹µë³€] 2024ë…„ AI ê¸°ìˆ  ë™í–¥ì— ëŒ€í•´...
```

## ğŸ”§ ì„¤ì •

### config.py ì£¼ìš” ì„¤ì •

```python
# LLM ëª¨ë¸ ì„¤ì •
llm = ChatOpenAI(model="gpt-4o-mini", temperature=0)

# í™˜ê²½ë³€ìˆ˜
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
```

### ë¡œì§ ì»¤ìŠ¤í„°ë§ˆì´ì§•

- **ë¶„ë¥˜ ë¡œì§**: `graph/logic/classification.py`
- **ì˜ì‚¬ê²°ì • ë¡œì§**: `graph/logic/decision.py`
- **ìœ í‹¸ë¦¬í‹°**: `graph/utils/` í´ë”

## ğŸ§ª í™•ì¥ ê°€ëŠ¥ì„±

### ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ëŠ¥ë“¤

1. **ë‹¤ì¤‘ ëª¨ë¸ ì§€ì›**
   - ë‹¤ì–‘í•œ LLM ëª¨ë¸ ì„ íƒ
   - ëª¨ë¸ë³„ íŠ¹í™” ë…¸ë“œ

2. **ê³ ê¸‰ RAG**
   - ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™
   - í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰

3. **ëŒ€í™” ê¸°ì–µ**
   - ëŒ€í™” íˆìŠ¤í† ë¦¬ ê´€ë¦¬
   - ì»¨í…ìŠ¤íŠ¸ ìœ ì§€

4. **ì‚¬ìš©ì ë§ì¶¤í™”**
   - ê°œì¸í™” ì„¤ì •
   - ì„ í˜¸ë„ í•™ìŠµ

5. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**
   - ì‘ë‹µ ì‹œê°„ ì¸¡ì •
   - í’ˆì§ˆ ë©”íŠ¸ë¦­ ìˆ˜ì§‘

## ğŸ“ ê°œë°œ ê°€ì´ë“œ

### ìƒˆë¡œìš´ ë…¸ë“œ ì¶”ê°€

1. `graph/nodes/` í´ë”ì— ìƒˆ íŒŒì¼ ìƒì„±
2. í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜: `def node_name(state: QAState) -> QAState:`
3. `graph_builder.py`ì— ë…¸ë“œ ë“±ë¡

### ìƒˆë¡œìš´ ë¡œì§ ì¶”ê°€

1. `graph/logic/` í´ë”ì— ìƒˆ íŒŒì¼ ìƒì„±
2. í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜: `def logic_name(state: QAState) -> str:`
3. `graph_builder.py`ì— ì¡°ê±´ë¶€ ì—£ì§€ ì¶”ê°€

### ìƒˆë¡œìš´ ìœ í‹¸ë¦¬í‹° ì¶”ê°€

1. `graph/utils/` í´ë”ì— ìƒˆ íŒŒì¼ ìƒì„±
2. ìˆœìˆ˜ í•¨ìˆ˜ë¡œ êµ¬í˜„
3. í•„ìš”í•œ ë…¸ë“œì—ì„œ ì„í¬íŠ¸ ì‚¬ìš©

## ğŸ¤ ê¸°ì—¬í•˜ê¸°

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë°°í¬ë©ë‹ˆë‹¤.

## ğŸ“ ë¬¸ì˜

í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì´ìŠˆë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”. 